name: Shift traffic to BLUE (manual)

on:
  workflow_dispatch:
    inputs:
      percent_to_blue:
        description: 'Percentage of traffic to route to BLUE'
        required: true

jobs:
  shift:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Make scripts executable
        run: chmod +x scripts/*.sh
      - name: Shift traffic
        run: |
          mkdir -p logs run
          ./scripts/shift_traffic.sh ${{ github.event.inputs.percent_to_blue }} 100 > logs/shift_run.log || true
      - name: Upload shift logs
        uses: actions/upload-artifact@v4
        with:
          name: shift-logs
          path: logs/shift_run.log
